FROM golang:1.19-alpine
WORKDIR /app

COPY go.mod ./
RUN go mod download

ENV TALAPAS_API_DIRECTOR_LISTEN_PORT=$TALAPAS_API_DIRECTOR_LISTEN_PORT
ENV TALAPAS_API_DIRECTOR_APP1_HOST=$TALAPAS_API_DIRECTOR_APP1_HOST
ENV TALAPAS_API_DIRECTOR_APP1_PORT=$TALAPAS_API_DIRECTOR_APP1_PORT
ENV TALAPAS_API_DIRECTOR_APP2_HOST=$TALAPAS_API_DIRECTOR_APP2_HOST
ENV TALAPAS_API_DIRECTOR_APP2_PORT=$TALAPAS_API_DIRECTOR_APP2_PORT

COPY . ./
RUN go build -o /talapas-api-director .

EXPOSE $TALAPAS_API_DIRECTOR_LISTEN_PORT
CMD ["/talapas-api-director"]
